DROP DATABASE IF EXISTS `recipe-app`;

CREATE DATABASE `recipe-app`;

SET FOREIGN_KEY_CHECKS=0;

CREATE TABLE `recipe-app`.`units`
(
	`id` INT NOT NULL AUTO_INCREMENT,
	`name` VARCHAR(255) NOT NULL,
	PRIMARY KEY (`id`)
) ENGINE = InnoDB;

CREATE TABLE `recipe-app`.`food`
(
	`id` INT NOT NULL AUTO_INCREMENT,
	`name` VARCHAR(255) NOT NULL,
	PRIMARY KEY (`id`)
) ENGINE = InnoDB;

CREATE TABLE `recipe-app`.`ingredients`
(
	`id` INT NOT NULL AUTO_INCREMENT,
	`amount` DOUBLE NULL,
	`unit_id` INT NOT NULL,
	`food_id` INT NOT NULL,
	PRIMARY KEY (`id`),
	CONSTRAINT `fk_ingredients-food` FOREIGN KEY (`food_id`) REFERENCES `food`(`id`)
		ON DELETE RESTRICT
		ON UPDATE CASCADE,
	CONSTRAINT `fk_ingredients-unit` FOREIGN KEY (`unit_id`) REFERENCES `units`(`id`)
		ON DELETE RESTRICT
		ON UPDATE CASCADE
) ENGINE = InnoDB;

CREATE TABLE `recipe-app`.`recipe` 
(
	`id` INT NOT NULL AUTO_INCREMENT,
	`name` VARCHAR(255) NOT NULL,
	`description` TEXT NULL,
	`instructions` TEXT NULL,
	`image` TEXT NULL,
	`url` TEXT NULL,
	PRIMARY KEY (`id`)
) ENGINE = InnoDB;

CREATE TABLE `recipe-app`.`recipe_ingredients` 
(
	`id` INT NOT NULL AUTO_INCREMENT,
	`recipe_id` INT NOT NULL,
	`ingredients_id` INT NOT NULL,
	PRIMARY KEY (`id`),
	CONSTRAINT `fk_recipe_ingredients-ingredient` FOREIGN KEY (`ingredients_id`) REFERENCES `ingredients`(`id`)
		ON DELETE RESTRICT
		ON UPDATE CASCADE,
	CONSTRAINT `fk_recipe_ingredients-recipe` FOREIGN KEY (`recipe_id`) REFERENCES `recipe`(`id`)
		ON DELETE RESTRICT
		ON UPDATE CASCADE
) ENGINE = InnoDB;

CREATE TABLE `recipe-app`.`recipe-planning`
(
	`id` INT NOT NULL AUTO_INCREMENT,
	`date` DATE NOT NULL,
	`recipe_id` INT NOT NULL,
	PRIMARY KEY (`id`)
) ENGINE = InnoDB;

SET FOREIGN_KEY_CHECKS=1;